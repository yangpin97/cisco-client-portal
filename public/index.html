<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cisco Secure Client</title>
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <script src="js/tailwind.min.js"></script>
    <link rel="icon" href="img/favicon.ico" type="image/x-icon">
    <script defer src="https://analytics.yydy.link/script.js" data-website-id="9fec2df5-5a25-47c7-8fd6-edc880d53552"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0070c9',
                        secondary: '#005ca8',
                        accent: '#00a8e8',
                        neutral: {
                            100: '#f5f5f7',
                            200: '#eaecee',
                            300: '#d1d5db',
                            400: '#9ca3af',
                            500: '#6b7280',
                            600: '#4b5563',
                            700: '#374151',
                            800: '#1f2937',
                            900: '#111827',
                        }
                    },
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif']
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card-hover {
                @apply transition-all duration-300 hover:shadow-xl hover:-translate-y-1;
            }
            .btn-hover {
                @apply transition-all duration-300 hover:shadow-md hover:-translate-y-0.5;
            }
            .modal-backdrop {
                @apply fixed inset-0 bg-black/50 z-40 flex items-center justify-center p-4 opacity-0 pointer-events-none transition-opacity duration-300;
            }
            .modal-backdrop.active {
                @apply opacity-100 pointer-events-auto;
            }
            .modal-content {
                @apply bg-white rounded-2xl shadow-2xl w-full max-w-md mx-auto overflow-hidden relative transform transition-all scale-95 opacity-0;
            }
            .modal-backdrop.active .modal-content {
                @apply scale-100 opacity-100;
            }
            .close-btn {
                @apply absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full bg-red-100 text-red-600 hover:bg-red-200 transition-colors z-10 cursor-pointer;
            }
            /* Banner Marquee Animation */
            .marquee-wrapper {
                mask-image: linear-gradient(to right, transparent, black 20px, black 95%, transparent);
            }
            .marquee-content {
                display: inline-block;
                animation: marquee 30s linear infinite;
            }
            .marquee-content:hover {
                animation-play-state: paused;
            }
            @keyframes marquee {
                0% { transform: translateX(0); }
                100% { transform: translateX(-50%); }
            }
        }
    </style>
</head>
<body class="bg-gray-50 text-neutral-800 min-h-screen">
    <!-- 粒子背景 - 科技感效果 -->
    <div id="particles-js" class="fixed inset-0 z-0 opacity-30"></div>

    <!-- 顶部导航 -->
    <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-20 transition-all duration-300">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <h1 id="headerTitle" class="text-xl sm:text-2xl font-bold">Cisco Secure Client</h1>
            </div>
            <!-- Top Right Buttons -->
            <div class="hidden md:flex items-center space-x-3">
                <button type="button" id="headerBtn1" class="px-4 py-1.5 rounded-full bg-gray-100 text-sm font-medium hover:bg-gray-200 transition-colors text-neutral-600"></button>
                <a id="headerBtn2" href="#" target="_blank" class="px-4 py-1.5 rounded-full bg-gray-100 text-sm font-medium hover:bg-gray-200 transition-colors text-neutral-600"></a>
                <a id="headerBtn3" href="#" target="_blank" class="px-4 py-1.5 rounded-full bg-gray-100 text-sm font-medium hover:bg-gray-200 transition-colors text-neutral-600"></a>
            </div>
        </div>
    </header>

    <!-- 滚动广告位 -->
    <div id="bannerSection" class="hidden w-full bg-white border-b border-gray-100 h-12 relative overflow-hidden z-10">
        <a id="bannerLink" href="#" target="_blank" class="block w-full h-full flex items-center text-sm no-underline hover:text-primary transition-colors">
            <!-- Fixed Icon Container -->
            <div class="flex-shrink-0 px-4 bg-white z-20 h-full flex items-center border-r border-gray-50">
                <img id="bannerIcon" src="" class="h-6 w-auto object-contain hidden">
            </div>
            
            <!-- Scrolling Text Area -->
            <div class="marquee-wrapper flex-1 relative h-full flex items-center overflow-hidden whitespace-nowrap">
                <div id="bannerTextContainer" class="marquee-content">
                    <!-- JS will inject duplicated content here -->
                </div>
            </div>
        </a>
    </div>

    <!-- 主内容 -->
    <main class="container mx-auto px-4 py-8 md:py-16 relative z-10">
        <!-- 标题区域 -->
        <div class="text-center max-w-3xl mx-auto mb-12 md:mb-20">
            <h2 id="mainTitle" class="text-4xl sm:text-5xl md:text-6xl font-bold mb-6 text-neutral-900">Cisco <span class="text-primary">Secure Client</span></h2>
            
            <!-- Badges -->
            <div class="flex justify-center items-center gap-4 mb-4 flex-wrap">
                <span class="px-3 py-1 rounded-full bg-green-50 text-green-700 text-xs font-medium flex items-center border border-green-100">
                    <span class="w-1.5 h-1.5 rounded-full bg-green-500 mr-2"></span> VPN: <span id="vpnVersionVal" class="ml-1"></span>
                </span>
                <span class="px-3 py-1 rounded-full bg-blue-50 text-blue-700 text-xs font-medium flex items-center border border-blue-100">
                    <span class="w-1.5 h-1.5 rounded-full bg-blue-500 mr-2"></span> UI: <span id="uiVersionVal" class="ml-1"></span>
                </span>
            </div>

            <p class="text-xs text-neutral-400 mb-8">最后更新: <span id="updateDateVal"></span></p>

            <!-- Main Button -->
            <button id="heroDownloadBtn" onclick="document.getElementById('downloadSection').scrollIntoView({behavior: 'smooth'})" class="bg-primary text-white px-8 py-3 rounded-lg font-medium hover:bg-secondary transition-all flex items-center justify-center mx-auto mb-12 shadow-lg hover:shadow-xl hover:-translate-y-0.5">
                <span id="heroBtnText">立即下载</span>
                <i class="fa fa-arrow-down ml-2"></i>
            </button>
            
            <p id="mainSubtitle" class="hidden">
                安全连接，无处不在。下载适用于您设备的Cisco Secure Client客户端，轻松建立安全连接。
            </p>
        </div>

        <!-- 下载区域 -->
        <section id="downloadSection" class="max-w-7xl mx-auto mb-16">
            <h3 id="downloadSectionTitle" class="text-2xl sm:text-3xl font-bold mb-2 text-center">选择您的平台</h3>
            <p id="downloadSectionSubtitle" class="text-center text-neutral-500 mb-12 text-sm">支持全平台设备的无缝接入体验</p>

            <!-- 统一平台 Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Windows -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover group p-6 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                        <i class="fa fa-windows text-4xl text-blue-600"></i>
                    </div>
                    <h4 class="text-lg font-bold mb-1">Windows</h4>
                    <p class="text-xs text-neutral-400 mb-6">Win XP 及以上</p>
                    
                    <div class="flex gap-2">
                        <button class="download-btn flex-1 bg-primary text-white py-2 px-2 rounded-lg font-medium hover:bg-secondary transition-colors flex items-center justify-center text-xs" data-platform="windows">
                            <i class="fa fa-download mr-1"></i> <span class="btn-text">下载</span>
                        </button>
                        <a href="#" class="manual-link flex-1 bg-white border border-gray-200 text-neutral-700 py-2 px-2 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-xs" data-platform="windows">
                            <i class="fa fa-book mr-1"></i> <span class="btn-text">手册</span>
                        </a>
                    </div>
                </div>

                <!-- macOS -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover group p-6 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                        <i class="fa fa-apple text-4xl text-neutral-800"></i>
                    </div>
                    <h4 class="text-lg font-bold mb-1">macOS</h4>
                    <p class="text-xs text-neutral-400 mb-6">10.13+</p>
                    
                    <div class="flex gap-2">
                        <button class="download-btn flex-1 bg-primary text-white py-2 px-2 rounded-lg font-medium hover:bg-secondary transition-colors flex items-center justify-center text-xs" data-platform="macos">
                            <i class="fa fa-download mr-1"></i> <span class="btn-text">下载</span>
                        </button>
                        <a href="#" class="manual-link flex-1 bg-white border border-gray-200 text-neutral-700 py-2 px-2 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-xs" data-platform="macos">
                            <i class="fa fa-book mr-1"></i> <span class="btn-text">手册</span>
                        </a>
                    </div>
                </div>

                <!-- Linux -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover group p-6 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                        <i class="fa fa-linux text-4xl text-orange-600"></i>
                    </div>
                    <h4 class="text-lg font-bold mb-1">Linux</h4>
                    <p class="text-xs text-neutral-400 mb-6">主流发行版</p>
                    
                    <div class="flex gap-2">
                        <button class="download-btn flex-1 bg-primary text-white py-2 px-2 rounded-lg font-medium hover:bg-secondary transition-colors flex items-center justify-center text-xs" data-platform="linux">
                            <i class="fa fa-download mr-1"></i> <span class="btn-text">下载</span>
                        </button>
                        <a href="#" class="manual-link flex-1 bg-white border border-gray-200 text-neutral-700 py-2 px-2 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-xs" data-platform="linux">
                            <i class="fa fa-book mr-1"></i> <span class="btn-text">手册</span>
                        </a>
                    </div>
                </div>

                <!-- iOS -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover group p-6 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                        <i class="fa fa-apple text-4xl text-neutral-800"></i>
                    </div>
                    <h4 class="text-lg font-bold mb-1">iOS</h4>
                    <p class="text-xs text-neutral-400 mb-6">iPhone & iPad</p>
                    
                    <div class="flex flex-col gap-3">
                        <a href="https://apps.apple.com/cn/app/cisco-secure-client/id1135064690" target="_blank" class="w-full bg-primary text-white py-2.5 px-4 rounded-lg font-medium hover:bg-secondary transition-colors flex items-center justify-center text-sm" id="iosDownloadBtn">
                            <i class="fa fa-download mr-2"></i> <span class="btn-text">App Store</span>
                        </a>
                        <div class="flex gap-3">
                            <a href="#" class="manual-link flex-1 bg-white border border-gray-200 text-neutral-700 py-2.5 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-sm" data-platform="ios">
                                <i class="fa fa-book"></i>
                            </a>
                            <button class="qr-btn flex-1 bg-white border border-gray-200 text-neutral-700 py-2.5 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-sm" data-platform="ios">
                                <i class="fa fa-qrcode"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Android -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover group p-6 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                        <i class="fa fa-android text-4xl text-green-600"></i>
                    </div>
                    <h4 class="text-lg font-bold mb-1">Android</h4>
                    <p class="text-xs text-neutral-400 mb-6">5.0+</p>
                    
                    <div class="flex flex-col gap-3">
                        <button class="download-btn w-full bg-primary text-white py-2.5 px-4 rounded-lg font-medium hover:bg-secondary transition-colors flex items-center justify-center text-sm" data-platform="android">
                            <i class="fa fa-download mr-2"></i> <span class="btn-text">下载 APK</span>
                        </button>
                        <div class="flex gap-3">
                            <a href="#" class="manual-link flex-1 bg-white border border-gray-200 text-neutral-700 py-2.5 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-sm" data-platform="android">
                                <i class="fa fa-book"></i>
                            </a>
                            <button class="qr-btn flex-1 bg-white border border-gray-200 text-neutral-700 py-2.5 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-sm" data-platform="android">
                                <i class="fa fa-qrcode"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- HarmonyOS -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover group p-6 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                        <i class="fa fa-mobile text-4xl text-red-600"></i>
                    </div>
                    <h4 class="text-lg font-bold mb-1">HarmonyOS</h4>
                    <p class="text-xs text-neutral-400 mb-6">Next / 4.0+</p>
                    
                    <div class="flex flex-col gap-3">
                        <a href="#" target="_blank" class="w-full bg-primary text-white py-2.5 px-4 rounded-lg font-medium hover:bg-secondary transition-colors flex items-center justify-center text-sm" id="harmonyDownloadBtn">
                            <i class="fa fa-download mr-2"></i> <span class="btn-text">AppGallery</span>
                        </a>
                        <div class="flex gap-3">
                            <a href="#" class="manual-link flex-1 bg-white border border-gray-200 text-neutral-700 py-2.5 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-sm" data-platform="harmony">
                                <i class="fa fa-book"></i>
                            </a>
                            <button class="qr-btn flex-1 bg-white border border-gray-200 text-neutral-700 py-2.5 px-4 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-sm" data-platform="harmony">
                                <i class="fa fa-qrcode"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 其他开源客户端 -->
        <div id="openConnectSection" class="hidden">
            <div class="flex items-center justify-center mb-12">
                <div class="h-px bg-gray-200 w-24"></div>
                <h3 id="footerTitle" class="text-xl font-bold mx-6 text-neutral-800">OpenConnect 开源客户端</h3>
                <div class="h-px bg-gray-200 w-24"></div>
            </div>

            <section id="otherClientsSection" class="max-w-5xl mx-auto mb-16">
                <div id="otherClientsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- 内容将通过JavaScript动态生成 -->
                </div>
            </section>
        </div>

        <!-- 其他客户端 (Custom) -->
        <div id="customClientsSection" class="hidden">
            <div class="flex items-center justify-center mb-12">
                <div class="h-px bg-gray-200 w-24"></div>
                <h3 class="text-xl font-bold mx-6 text-neutral-800">其他开源客户端</h3>
                <div class="h-px bg-gray-200 w-24"></div>
            </div>

            <section class="max-w-5xl mx-auto mb-16">
                <div id="customClientsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- 内容将通过JavaScript动态生成 -->
                </div>
            </section>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-gray-50 border-t border-gray-200 py-12 relative z-10">
        <div class="container mx-auto px-4 text-center">
            <p id="footerCopyright" class="text-neutral-400 text-sm">© 2025 Cisco Secure Client Navigation. Powered by BLOG.YYDY.LINK</p>
        </div>
    </footer>

    <!-- 下载弹窗 -->
    <div id="downloadModal" class="modal-backdrop">
        <div class="modal-content">
            <button id="closeDownloadModal" class="close-btn" aria-label="关闭">
                <i class="fa fa-times"></i>
            </button>
            <div class="p-6">
                <h3 id="modalTitle" class="text-xl font-bold mb-6"></h3>
                <div id="versionOptions" class="space-y-4 mb-6">
                    <!-- 版本选项将通过JavaScript动态生成 -->
                </div>
            </div>
        </div>
    </div>

    <!-- 二维码弹窗 -->
    <div id="qrModal" class="modal-backdrop">
        <div class="modal-content max-w-xs">
            <button id="closeQrModal" class="close-btn" aria-label="关闭">
                <i class="fa fa-times"></i>
            </button>
            <div class="p-6 text-center">
                <h3 id="qrModalTitle" class="text-xl font-bold mb-6"></h3>
                <div class="flex justify-center">
                    <img id="qrImage" src="" alt="下载二维码" class="max-w-full h-auto rounded-lg">
                </div>
                <p class="mt-4 text-sm text-neutral-500">请使用手机扫描二维码下载</p>
            </div>
        </div>
    </div>

    <!-- 粒子背景库 -->
    <script src="js/particles.min.js"></script>
    <!-- 主脚本 -->
    <script>
        // 全局数据存储
        let appData = null;

        // 用于显示的友好平台名称（保证 iOS/macOS 正确）
        function prettyPlatformName(platform) {
            if (!platform) return '';
            const p = String(platform).toLowerCase().trim();
            if (p === 'ios') return 'iOS';
            if (p === 'macos' || p === 'mac os' || p === 'mac') return 'macOS';
            if (p === 'windows' || p === 'win') return 'Windows';
            if (p === 'linux') return 'Linux';
            if (p === 'android') return 'Android';
            if (p === 'harmony' || p === 'harmonyos') return 'HarmonyOS';
            return platform.charAt(0).toUpperCase() + platform.slice(1);
        }

        // 将平台名映射到 data.texts 的键（例如 ios -> manualIOS，macos -> manualMacOS）
        function platformToTextKey(platform) {
            if (!platform) return '';
            const p = String(platform).toLowerCase().trim();
            if (p === 'ios') return 'manualIOS';
            if (p === 'macos' || p === 'mac os' || p === 'mac') return 'manualMacOS';
            if (p === 'harmony' || p === 'harmonyos') return 'manualHarmony';
            // 默认 manual + 首字母大写其余原样（Windows -> manualWindows, Linux -> manualLinux, Android -> manualAndroid）
            return 'manual' + platform.charAt(0).toUpperCase() + platform.slice(1);
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            // 初始化粒子背景
            initParticles();

            // 加载数据
            loadData();

            // 设置定时刷新数据
            setInterval(loadData, 30000); // 每30秒刷新一次

            // 监听localStorage变化，实现跨页面实时更新
            window.addEventListener('storage', (e) => {
                if (e.key === 'ciscoDataUpdated') {
                    loadData();
                }
            });

            // 绑定下载按钮事件（除了iOS）
            document.querySelectorAll('.download-btn:not([data-platform="ios"])').forEach(btn => {
                btn.addEventListener('click', () => {
                    const platform = btn.getAttribute('data-platform');
                    openDownloadModal(platform);
                });
            });

            // 绑定二维码按钮事件
            document.querySelectorAll('.qr-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const platform = btn.getAttribute('data-platform');
                    openQrModal(platform);
                });
            });

            // 绑定用户手册链接事件
            document.querySelectorAll('.manual-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const platform = link.getAttribute('data-platform');
                    openManual(platform);
                });
            });

            // 绑定关闭弹窗事件
            document.getElementById('closeDownloadModal').addEventListener('click', () => {
                closeDownloadModal();
            });

            document.getElementById('closeQrModal').addEventListener('click', () => {
                closeQrModal();
            });

            // 点击弹窗背景关闭弹窗
            document.getElementById('downloadModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('downloadModal')) {
                    closeDownloadModal();
                }
            });

            document.getElementById('qrModal').addEventListener('click', (e) => {
                if (e.target === document.getElementById('qrModal')) {
                    closeQrModal();
                }
            });

            // 按ESC键关闭弹窗
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeDownloadModal();
                    closeQrModal();
                }
            });

            // 滚动时调整导航栏样式
            window.addEventListener('scroll', () => {
                const header = document.querySelector('header');
                if (window.scrollY > 10) {
                    header.classList.add('shadow-md');
                    header.classList.remove('shadow-sm');
                } else {
                    header.classList.remove('shadow-md');
                    header.classList.add('shadow-sm');
                }
            });
        });

        // 初始化粒子背景 - 科技感效果
        function initParticles() {
            if (typeof particlesJS !== 'undefined') {
                particlesJS('particles-js', {
                    "particles": {
                        "number": {
                            "value": 100,
                            "density": {
                                "enable": true,
                                "value_area": 800
                            }
                        },
                        "color": {
                            "value": ["#0070c9", "#00a8e8", "#005ca8"]
                        },
                        "shape": {
                            "type": ["circle", "triangle", "polygon"],
                            "stroke": {
                                "width": 0,
                                "color": "#000000"
                            },
                            "polygon": {
                                "nb_sides": 5
                            }
                        },
                        "opacity": {
                            "value": 0.6,
                            "random": true,
                            "anim": {
                                "enable": true,
                                "speed": 1,
                                "opacity_min": 0.2,
                                "sync": false
                            }
                        },
                        "size": {
                            "value": 3,
                            "random": true,
                            "anim": {
                                "enable": true,
                                "speed": 2,
                                "size_min": 1,
                                "sync": false
                            }
                        },
                        "line_linked": {
                            "enable": true,
                            "distance": 150,
                            "color": "#0070c9",
                            "opacity": 0.4,
                            "width": 1,
                            "shadow": {
                                "enable": true,
                                "color": "#0070c9",
                                "blur": 1
                            }
                        },
                        "move": {
                            "enable": true,
                            "speed": 1.5,
                            "direction": "none",
                            "random": true,
                            "straight": false,
                            "out_mode": "out",
                            "bounce": false,
                            "attract": {
                                "enable": true,
                                "rotateX": 600,
                                "rotateY": 1200
                            }
                        }
                    },
                    "interactivity": {
                        "detect_on": "canvas",
                        "events": {
                            "onhover": {
                                "enable": true,
                                "mode": "grab"
                            },
                            "onclick": {
                                "enable": true,
                                "mode": "push"
                            },
                            "resize": true
                        },
                        "modes": {
                            "grab": {
                                "distance": 180,
                                "line_linked": {
                                    "opacity": 0.8,
                                    "width": 2
                                }
                            },
                            "push": {
                                "particles_nb": 6
                            }
                        }
                    },
                    "retina_detect": true
                });
            } else {
                console.error('粒子特效库未加载，请检查资源链接');
                document.getElementById('particles-js').classList.add('bg-gradient-to-br', 'from-primary/5', 'to-accent/5');
            }
        }

        // 从服务器加载数据
        async function loadData() {
            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                appData = data;
                updateUI(data);
            } catch (error) {
                console.error('加载数据失败:', error);
            }
        }

        // 更新UI显示
        function updateUI(data) {
            const texts = data.texts || {};
            const nav = data.headerNav || {};
            const banner = data.banner || {};

            // Update Banner
            const bannerSection = document.getElementById('bannerSection');
            if (banner.visible !== false) {
                bannerSection.classList.remove('hidden');
                document.getElementById('bannerLink').href = banner.link || '#';
                
                const icon = document.getElementById('bannerIcon');
                const iconContainer = icon.parentElement;
                if (banner.image) {
                    icon.src = banner.image;
                    icon.classList.remove('hidden');
                    iconContainer.classList.remove('hidden');
                } else {
                    icon.classList.add('hidden');
                    iconContainer.classList.add('hidden');
                }

                // Create text content once
                const textHtml = `
                    <span class="text-neutral-600">${banner.text1 || ''}</span>
                    <span class="text-red-600 font-bold mx-1">${banner.text2 || ''}</span>
                    <span class="text-green-600 font-bold mx-1">${banner.text3 || ''}</span>
                    <span class="text-neutral-600">${banner.text4 || ''}</span>
                `;

                // Inject duplicated content for seamless scrolling
                const container = document.getElementById('bannerTextContainer');
                container.innerHTML = `
                    <div class="inline-flex items-center gap-1 pr-24">${textHtml}</div>
                    <div class="inline-flex items-center gap-1 pr-24">${textHtml}</div>
                `;
            } else {
                bannerSection.classList.add('hidden');
            }

            // 更新Header按钮
            const btn1 = document.getElementById('headerBtn1');
            const btn2 = document.getElementById('headerBtn2');
            const btn3 = document.getElementById('headerBtn3');
            
            if (btn1) { 
                if (nav.btn1?.visible !== false) {
                    btn1.style.display = 'inline-block';
                    btn1.textContent = nav.btn1?.text || '飞将咨询'; 
                    // 绑定点击事件打开二维码
                    btn1.onclick = () => openQrModal('consulting');
                } else {
                    btn1.style.display = 'none';
                }
            }
            
            if (btn2) { 
                if (nav.btn2?.visible !== false) {
                    btn2.style.display = 'inline-block';
                    btn2.textContent = nav.btn2?.text || '飞将官网'; 
                    btn2.href = nav.btn2?.url || '#'; 
                } else {
                    btn2.style.display = 'none';
                }
            }
            
            if (btn3) { 
                if (nav.btn3?.visible !== false) {
                    btn3.style.display = 'inline-block';
                    btn3.textContent = nav.btn3?.text || '博客站'; 
                    btn3.href = nav.btn3?.url || '#'; 
                } else {
                    btn3.style.display = 'none';
                }
            }

            // 更新Hero区域
            document.getElementById('headerTitle').textContent = texts.title || 'Cisco Secure Client';
            // 尝试保持Title的样式
            const titleHtml = texts.title ? texts.title.replace('Secure Client', '<span class="text-primary">Secure Client</span>') : 'Cisco <span class="text-primary">Secure Client</span>';
            document.getElementById('mainTitle').innerHTML = titleHtml;
            
            document.getElementById('vpnVersionVal').textContent = texts.vpnVersion || 'v5.1.1.145';
            document.getElementById('uiVersionVal').textContent = texts.uiVersion || 'v5.1.14.1452';
            document.getElementById('updateDateVal').textContent = texts.updateDate || '2025-12-25';
            
            const heroBtnText = document.getElementById('heroBtnText');
            if (heroBtnText) heroBtnText.textContent = texts.heroBtnText || '立即下载';

            document.getElementById('downloadSectionTitle').textContent = texts.downloadSectionTitle || '选择您的平台';
            document.getElementById('downloadSectionSubtitle').textContent = texts.downloadSectionSubtitle || '支持全平台设备的无缝接入体验';
            
            const footerTitle = document.getElementById('footerTitle');
            if (footerTitle) footerTitle.textContent = texts.footerTitle || 'OpenConnect 开源客户端';
            
            const footerCopyright = document.getElementById('footerCopyright');
            if (footerCopyright) footerCopyright.innerHTML = texts.footerCopyright || '© 2025 Cisco Secure Client Navigation. Powered by BLOG.YYDY.LINK';

            // 更新通用按钮文本
            const commonDownloadText = texts.commonDownloadText || '下载';
            const commonManualText = texts.commonManualText || '手册';
            
            document.querySelectorAll('.download-btn .btn-text').forEach(el => {
                // 排除iOS和Android的特定按钮
                const parent = el.closest('button') || el.closest('a');
                const platform = parent.getAttribute('data-platform');
                // 注意：iOS/Android按钮可能不是 .download-btn 类，或者有特定逻辑
                // 这里我们只更新桌面端的通用下载按钮
                if (platform === 'windows' || platform === 'macos' || platform === 'linux') {
                    el.textContent = commonDownloadText;
                }
            });

            document.querySelectorAll('.manual-link .btn-text').forEach(el => {
                el.textContent = commonManualText;
            });

            // 更新用户手册链接
            Object.keys(data.manuals || {}).forEach(platform => {
                const link = document.querySelector(`.manual-link[data-platform="${platform}"]`);
                if (link) {
                    if (data.manuals[platform]) {
                        link.href = data.manuals[platform];
                        link.classList.remove('opacity-50', 'pointer-events-none');
                    } else {
                        link.classList.add('opacity-50', 'pointer-events-none');
                    }
                    
                    // 更新按钮文本 (如果有特定配置)
                    const textKey = platformToTextKey(platform);
                    // 这里我们保持 "手册" 两个字，除非有特殊需求修改
                }
            });

            // 更新下载按钮文本 (iOS/Android)
            const iosBtn = document.getElementById('iosDownloadBtn');
            if (iosBtn) {
                if (texts.iosDownloadUrl) {
                    iosBtn.href = texts.iosDownloadUrl;
                }
                const iosBtnText = iosBtn.querySelector('.btn-text');
                if (iosBtnText && texts.iosButtonText) {
                    iosBtnText.textContent = texts.iosButtonText;
                }
            }

            const androidBtnText = document.querySelector('button[data-platform="android"] .btn-text');
            if (androidBtnText && texts.androidButtonText) androidBtnText.textContent = texts.androidButtonText;

            // Update HarmonyOS button
            const harmonyBtn = document.getElementById('harmonyDownloadBtn');
            if (harmonyBtn) {
                if (data.downloads?.harmony) {
                    harmonyBtn.href = data.downloads.harmony;
                }
            }


            // 更新OpenConnect客户端
            renderClientList(data.openConnectClients, 'openConnectSection', 'otherClientsContainer');

            // 更新其他客户端 (Custom)
            renderClientList(data.customClients, 'customClientsSection', 'customClientsContainer');
        }

        // 渲染客户端列表通用函数
        function renderClientList(clients, sectionId, containerId) {
            const section = document.getElementById(sectionId);
            const container = document.getElementById(containerId);
            
            if (clients && clients.length > 0) {
                section.classList.remove('hidden');
                container.innerHTML = '';

                clients.forEach(client => {
                    const clientCard = document.createElement('div');
                    // Updated container styles based on screenshot
                    clientCard.className = 'bg-white rounded-2xl border border-blue-100 p-6 shadow-sm hover:shadow-md transition-all duration-300 flex flex-col h-full';
                    
                    const iconClass = client.icon || 'fa-globe';
                    
                    // Dynamic icon colors
                    let iconBg = 'bg-blue-50';
                    let iconText = 'text-blue-600';
                    if (iconClass.includes('android')) { iconBg = 'bg-green-50'; iconText = 'text-green-600'; }
                    else if (iconClass.includes('apple')) { iconBg = 'bg-gray-100'; iconText = 'text-gray-800'; }
                    else if (iconClass.includes('linux')) { iconBg = 'bg-orange-50'; iconText = 'text-orange-600'; }
                    else if (iconClass.includes('mobile')) { iconBg = 'bg-indigo-50'; iconText = 'text-indigo-600'; }
                    else if (iconClass.includes('windows')) { iconBg = 'bg-blue-50'; iconText = 'text-blue-600'; }
                    
                    clientCard.innerHTML = `
                        <div class="flex items-center gap-4 mb-6">
                            <div class="w-14 h-14 rounded-full ${iconBg} ${iconText} flex items-center justify-center shrink-0">
                                <i class="fa ${iconClass} text-2xl"></i>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-gray-900 leading-tight">${client.name}</h4>
                                <p class="text-sm text-gray-500 mt-1">${client.os || '通用'}</p>
                            </div>
                        </div>
                        
                        <div class="flex-grow"></div>
                        
                        <div class="flex gap-3">
                            <a href="${client.url}" target="_blank" class="flex-1 bg-blue-50 text-blue-600 border border-blue-100 py-2 px-3 rounded-lg font-medium hover:bg-blue-100 transition-colors flex items-center justify-center text-sm">
                                下载
                            </a>
                            <a href="${client.manual}" target="_blank" class="flex-1 bg-white text-gray-600 border border-gray-200 py-2 px-3 rounded-lg font-medium hover:bg-gray-50 transition-colors flex items-center justify-center text-sm">
                                手册
                            </a>
                            ${client.qrCode ? `
                            <button onclick="openClientQrModal('${client.name}', '${client.qrCode}')" class="w-10 shrink-0 flex items-center justify-center bg-white text-gray-400 border border-gray-200 rounded-lg hover:text-gray-600 hover:border-gray-300 transition-colors">
                                <i class="fa fa-qrcode"></i>
                            </button>
                            ` : ''}
                        </div>
                    `;
                    container.appendChild(clientCard);
                });
            } else {
                section.classList.add('hidden');
            }
        }

        // 打开用户手册
        function openManual(platform) {
            if (!appData || !appData.manuals) return;
            
            const manualData = appData.manuals[platform];
            
            // 如果是 macOS, Linux 或 Android，且是对象形式（新数据结构），则打开弹窗
            if ((platform === 'macos' || platform === 'linux' || platform === 'android') && typeof manualData === 'object') {
                openManualModal(platform, manualData);
                return;
            }
            
            // 兼容旧数据或单链接平台
            if (manualData) {
                if (typeof manualData === 'string') {
                    window.open(manualData, '_blank');
                } else if (typeof manualData === 'object' && platform === 'windows' && manualData.link1) {
                    // Fallback for windows if it's still an object
                    window.open(manualData.link1, '_blank');
                }
            }
        }

        // 打开手册弹窗
        function openManualModal(platform, data) {
            const modal = document.getElementById('downloadModal'); // 复用下载弹窗样式
            const modalTitle = document.getElementById('modalTitle');
            const versionOptions = document.getElementById('versionOptions');

            modalTitle.innerHTML = `<i class="fa fa-book text-blue-500 mr-2"></i> ${prettyPlatformName(platform)} 使用手册`;
            versionOptions.innerHTML = '';

            if (platform === 'macos') {
                if (data.appStore) addVersionOption(versionOptions, 'App Store 版手册', data.appStore);
                if (data.dmg) addVersionOption(versionOptions, 'DMG 桌面版手册', data.dmg);
            } else if (platform === 'linux') {
                if (data.server) addVersionOption(versionOptions, 'Server 版配置', data.server);
                if (data.desktop) addVersionOption(versionOptions, 'Desktop 版配置', data.desktop);
            } else if (platform === 'android') {
                if (data.latest) addVersionOption(versionOptions, '新版本使用指南', data.latest);
                if (data.old) addVersionOption(versionOptions, '旧版本使用指南', data.old);
            }

            // 修改图标为手册图标 (可选优化，这里复用下载样式所以还是下载图标，可以改成external link)
            const icons = versionOptions.querySelectorAll('.fa-download');
            icons.forEach(icon => {
                icon.classList.remove('fa-download');
                icon.classList.add('fa-external-link');
            });

            modal.classList.add('active');
        }

        // 打开下载弹窗
        function openDownloadModal(platform) {
            if (!appData) return;

            const modal = document.getElementById('downloadModal');
            const modalTitle = document.getElementById('modalTitle');
            const versionOptions = document.getElementById('versionOptions');

            modalTitle.textContent = `${prettyPlatformName(platform)} 下载`;
            versionOptions.innerHTML = '';

            const downloads = appData.downloads || {};
            const platformData = downloads[platform];

            if (platform === 'windows' && platformData) {
                if (platformData.amdLatest) addVersionOption(versionOptions, 'AMD64 最新版', platformData.amdLatest);
                if (platformData.amdStable) addVersionOption(versionOptions, 'AMD64 稳定版', platformData.amdStable);
                if (platformData.armLatest) addVersionOption(versionOptions, 'ARM64 最新版', platformData.armLatest);
                if (platformData.armStable) addVersionOption(versionOptions, 'ARM64 稳定版', platformData.armStable);
                if (platformData.win7Amd) addVersionOption(versionOptions, 'Win7/8 AMD64 老版本', platformData.win7Amd);
                if (platformData.win7Arm) addVersionOption(versionOptions, 'Win7/8 ARM64 老版本', platformData.win7Arm);
            }
            else if (platform === 'macos' && platformData) {
                if (platformData.intel) addVersionOption(versionOptions, 'Intel 芯片版', platformData.intel);
                if (platformData.silicon) addVersionOption(versionOptions, 'Apple Silicon (M1/M2/M3)', platformData.silicon);
                if (platformData.oldOsx) addVersionOption(versionOptions, 'OSX (Maverick/Yosemite) 老版本', platformData.oldOsx);
                if (platformData.appStore) addVersionOption(versionOptions, 'App Store 版本', platformData.appStore);
            }
            else if (platform === 'linux' && platformData) {
                if (platformData.amdDeb) addVersionOption(versionOptions, 'Linux AMD64 (Debian/Ubuntu | deb)', platformData.amdDeb);
                if (platformData.amdRpm) addVersionOption(versionOptions, 'Linux AMD64 (RedHat/CentOS | rpm)', platformData.amdRpm);
                if (platformData.armDeb) addVersionOption(versionOptions, 'Linux ARM64 (Debian/Ubuntu | deb)', platformData.armDeb);
                if (platformData.armRpm) addVersionOption(versionOptions, 'Linux ARM64 (RedHat/CentOS | rpm)', platformData.armRpm);
                if (platformData.amdOther) addVersionOption(versionOptions, 'Linux AMD64 Other (非deb/rpm)', platformData.amdOther);
                if (platformData.armOther) addVersionOption(versionOptions, 'Linux ARM64 Other (非deb/rpm)', platformData.armOther);
            }
            else if (platform === 'android' && platformData) {
                if (platformData.latest) addVersionOption(versionOptions, '最新版本 APK', platformData.latest);
                if (platformData.old) addVersionOption(versionOptions, '旧版本 APK', platformData.old);
            }

            modal.classList.add('active');
        }

        // 关闭下载弹窗
        function closeDownloadModal() {
            const modal = document.getElementById('downloadModal');
            modal.classList.remove('active');
        }

        // 添加版本选项到弹窗
        function addVersionOption(container, label, url) {
            const option = document.createElement('div');
            // 样式调整：更紧凑的列表样式，背景色改为白色，边框更细
            option.className = 'group flex items-center justify-between p-3 bg-white border border-gray-100 rounded-lg hover:bg-gray-50 transition-colors cursor-pointer';
            
            // 点击整个选项区域触发下载
            option.onclick = () => window.open(url, '_blank');
            
            option.innerHTML = `
                <span class="text-sm font-medium text-gray-700 group-hover:text-primary transition-colors">${label}</span>
                <i class="fa fa-download text-gray-400 group-hover:text-primary transition-colors text-sm"></i>
            `;
            container.appendChild(option);
        }

        // 打开二维码弹窗
        function openQrModal(platform) {
            if (!appData) return;

            const modal = document.getElementById('qrModal');
            const qrModalTitle = document.getElementById('qrModalTitle');
            const qrImage = document.getElementById('qrImage');
            
            let titleText = '';
            let qrPath = '';
            let hintText = '请使用手机扫描二维码下载';

            if (platform === 'consulting') {
                const nav = appData.headerNav || {};
                titleText = nav.btn1?.text || '咨询';
                qrPath = appData.qrcodes?.consulting || '';
                hintText = '请扫描上方二维码进行咨询';
            } else {
                titleText = `${prettyPlatformName(platform)} 扫码下载`;
                qrPath = appData.qrcodes?.[platform] || `img/${platform}-qr.png`;
            }

            qrModalTitle.textContent = titleText;
            qrImage.src = qrPath;
            qrImage.alt = titleText;
            
            // 更新提示文字
            const hintP = modal.querySelector('p.text-sm');
            if (hintP) hintP.textContent = hintText;
            
            modal.classList.add('active');
        }

        // 关闭二维码弹窗
        function closeQrModal() {
            const modal = document.getElementById('qrModal');
            modal.classList.remove('active');
        }

        // 打开自定义客户端二维码
        function openClientQrModal(title, path) {
            const modal = document.getElementById('qrModal');
            const qrModalTitle = document.getElementById('qrModalTitle');
            const qrImage = document.getElementById('qrImage');
            
            qrModalTitle.textContent = title;
            qrImage.src = path;
            qrImage.alt = title;
            
            // 更新提示文字
            const hintP = modal.querySelector('p.text-sm');
            if (hintP) hintP.textContent = '请使用手机扫描二维码下载';
            
            modal.classList.add('active');
        }
    </script>
</body>
</html>
